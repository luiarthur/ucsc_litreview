This version using pass by value, which turns out
to be slightly slower. I guess by ref is better here.
