#!/usr/bin/env python

import os, sys

SRC_DIR = "../src/"
UPDATES_DIR = SRC_DIR + "updates/"
UPDATES_INCLUDES_H = "updates_includes.h"


def gen_new_hfile_contents(f):
    return """#ifndef <NAME_OF_FILE>
#define <NAME_OF_FILE>

//STUFF

#endif
""".replace("<NAME_OF_FILE>", f.upper()).replace('.', '_')


def writeFile(filepath, data):
    with open(filepath,"w") as f:
        f.write(data)
        f.close()


def list_observable_files(d):
    f = os.listdir(d)
    return filter(lambda x: x[0] != '.', f)

UPDATES_FILES = list_observable_files(UPDATES_DIR)
INCLUDES = ['#include "updates/' + f + '"' for f in UPDATES_FILES]
#print "\n".join(INCLUDES)

UPDATES_INCLUDES_H_CONTENTS = """// Generated by `./gen_updates_includes`. Do not edit by hand!
""" + gen_new_hfile_contents(UPDATES_INCLUDES_H).replace('//STUFF', "\n".join(INCLUDES))


#print UPDATES_INCLUDES_H_CONTENTS
writeFile(SRC_DIR + UPDATES_INCLUDES_H, UPDATES_INCLUDES_H_CONTENTS)
